# ğŸ“Š TÃ©cnicas avanÃ§adas de Power BI

<p align="justify"> 
Projeto em Power BI com a base de dados AdventureWorks (uma empresa fictÃ­cia criada pela Microsoft), sendo desenvolvido a partir de material e atividades prÃ¡ticas do curso online _TÃ©cnicas AvanÃ§adas de Power BI_, realizado na plataforma LinkedIn Learning.  
</p>  

#### ğŸ“‘ **CONTEÃšDOS DO CURSO:**

â˜‘ï¸ **0. IntroduÃ§Ã£o**  
ğŸ”¹ Bem-vindos ao curso avanÃ§ado de Power BI | ğŸ”¹ O que vocÃª precisa saber para aproveitar esse curso   

â˜‘ï¸ **1. Conceitos e objetivos do Business Intelligence**  
ğŸ”¹ Conceito e importÃ¢ncia do business intelligence  
<p align="center">
	<img src="https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/processo-bi.png" width="380">
</p>

ğŸ”¹ [ApresentaÃ§Ã£o dos arquivos e projeto do curso](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/arq-projeto.png)  
[[Arquivos de exercÃ­cios]](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/tree/main/arquivos_de_exercicios_power_bi_avancado)    

â˜‘ï¸ **2. Conhecendo o ecossistema do Power BI**   
ğŸ”¹ [Compreenda as diferentes plataformas da Microsoft para anÃ¡lise de dados](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/plataformas-desenvolvimento.png) | ğŸ”¹ [ConheÃ§a outros softwares de Business Intelligence](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/outros-softwares-bi.png)

â˜‘ï¸ **3. ImportaÃ§Ã£o de dados**  
ğŸ”¹ ConheÃ§a os diferentes tipos de dados (Exemplo de funcionalidade: [ODBC - conector universal de dados](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/conector-universal-dados.png)) | ğŸ”¹ [Como importar dados do Excel e funÃ§Ãµes da linguagem M (Power Query)](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/arquivos_de_exercicios_power_bi_avancado/Cap.3) | ğŸ”¹ [Como importar dados de CSV e TXT](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/arquivos_de_exercicios_power_bi_avancado/Cap.3) | ğŸ”¹ [Como importar dados da pasta](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/arquivos_de_exercicios_power_bi_avancado/Cap.3) | ğŸ”¹ [Como importar dados do SQL Server](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/importa-sql-server.png) (Exemplo de importaÃ§Ã£o do SQL Server [com filtro](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/importa-sqlserver-comfiltro.png)) | ğŸ”¹ [Como importar dados de fontes da Web utilizando tabelas](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/arquivos_de_exercicios_power_bi_avancado/Cap.3) | ğŸ”¹ [Como importar dados de fontes da Web utilizando exemplos](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/arquivos_de_exercicios_power_bi_avancado/Cap.3)  

â˜‘ï¸ **4. Tratamento de dados importados**  
ğŸ”¹ ApresentaÃ§Ã£o da linguagem M  

Linguagem M | Linguagem DAX  
-|-
Realizada por etapas; editor avanÃ§ado (guia ExibiÃ§Ã£o) agrupa funÃ§Ãµes por etapas. | Utilizadas para criar cÃ¡lculos e medidas.
FunÃ§Ãµes sÃ£o escritas em inglÃªs e argumentos separados por vÃ­rgula.| Pode ser acessada somente dentro do Power BI.
Presente apenas dentro do Power Query. | NÃ£o Ã© possÃ­vel utilizar funÃ§Ãµes DAX dentro do Power Query.  

ğŸ”¹ [IntroduÃ§Ã£o ao editor de consultas avanÃ§ado](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/editor-avancado.png) | ğŸ”¹ [Limpar dados indesejados](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/tree/main/arquivos_de_exercicios_power_bi_avancado/Cap.4%20Renomeado) | ğŸ”¹ [Transforme colunas em linhas](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/tree/main/arquivos_de_exercicios_power_bi_avancado/Cap.4%20Renomeado) | ğŸ”¹ [Utilize o preenchimento para cima e para baixo](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/tree/main/arquivos_de_exercicios_power_bi_avancado/Cap.4%20Renomeado) | ğŸ”¹ [A importÃ¢ncai dos tipos de dados](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/tree/main/arquivos_de_exercicios_power_bi_avancado/Cap.4%20Renomeado) | ğŸ”¹ [Juntar dados](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/tree/main/arquivos_de_exercicios_power_bi_avancado/Cap.4%20Renomeado) | ğŸ”¹ [Mesclar dados](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/tree/main/arquivos_de_exercicios_power_bi_avancado/Cap.4%20Renomeado) | ğŸ”¹ [Crie colunas adicionais](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/tree/main/arquivos_de_exercicios_power_bi_avancado/Cap.4%20Renomeado)ğŸ”¹ [Referencie e duplique tabelas](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/tree/main/arquivos_de_exercicios_power_bi_avancado/Cap.4%20Renomeado) | ğŸ”¹ [Agrupe dados no Power Query](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/tree/main/arquivos_de_exercicios_power_bi_avancado/Cap.4%20Renomeado) | ğŸ”¹ [Modifique o endereÃ§o de uma fonte de dados](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/modifica-endereco-fonte.png)  

â˜‘ï¸ **5. Relacionando dados**  
ğŸ”¹[Compreenda a cardinalidade dos dados](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/cardinalidade-dados.png)  
Na modelagem de dados, CARDINALIDADE significa o grau de relaÃ§Ã£o entre colunas e tabelas.  
ğŸ”¹ Explore os tipos de tabelas e colunas do modelo  
Conceitos de tabela fato, tabela dimensÃ£o ou cadastro, chave primÃ¡ria e chave estrangeira foram demonstrados atravÃ©s das tabelas que compÃµem a base de dados [AdventureWorks](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/arquivos_de_exercicios_power_bi_avancado/Cap.5/AdventureWorks.accdb) em Access.   
ğŸ”¹ Compreenda o  motivo de tabelas dimensÃ£o e fato  
DiferenÃ§a entre relatÃ³rios e modelo de dados  

RelatÃ³rios | Modelos de Dados
-|-
Servem para consulta rÃ¡pida; tem todas as descriÃ§Ãµes dos campos e possibilitam fazer uma tabela dinÃ¢mica usando apenas um conjunto de dados. | No Power BI podemos relacionar tabelas separadas e usar seus campos de modo performÃ¡tico. Ã‰ possÃ­vel usar relatÃ³rios dentro do Power BI sem explorar suas capacidades.  

ğŸ”¹ [Estabelecendo relacionamento no Power BI](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/relacionamenos-adventure.png)  

â˜‘ï¸ **6. IntroduÃ§Ã£o Ã  Linguagem DAX**  
ğŸ”¹ [IntroduÃ§Ã£o ao DAX](https://github.com/rosacarla/PowerBI-tecnicas-avancadas/blob/main/images/dax-funcoes-sintaxe.png)  
Linguagem DAX Ã© acrÃ´nimo para _Data Analysis Expressions_ (em portuguÃªs, expressÃµes de anÃ¡lises de dados), que Ã© uma linguagem utilizada no Power BI para cÃ¡lculos.  
ğŸ”¹ [Utilize funÃ§Ãµes de agregaÃ§Ã£o]() | ğŸ”¹ [Compreenda a lÃ³gica de cÃ¡lculo de funÃ§Ãµes DAX]() | ğŸ”¹[Criando uma coluna calculada]() | ğŸ”¹ [Realize uma divisÃ£o segura com a DIVIDE]() | ğŸ”¹ [IntroduÃ§Ã£o Ã  funÃ§Ã£o CALCULATE]() | ğŸ”¹ [FunÃ§Ã£o ALL e ALLSELECTED]()  

â˜‘ï¸ **7. CÃ¡lculos avanÃ§ados com DAX**  
ğŸ”¹ IntroduÃ§Ã£o Ã s funÃ§Ãµes iterantes  
FunÃ§Ã£o DAX em uso:  
Substituir coluna calculada por uma medida calculada (tem menos custo computacional) com SUMX, assim hÃ¡ modificaÃ§Ã£o do contexto de filtro. Em SUMX a medida cria um cÃ¡lculo diferente considerando todas as linhas do cocntexto inserido. Sempre que uma funÃ§Ã£o pede uma tabela como argumento Ã© iterante.
```
Valor Desconto 3 = SUMX('Pedidos Detalhes','Pedidos Detalhes'[PreÃ§o UnitÃ¡rio]*'Pedidos Detalhes'[Desconto])  
```  
ğŸ”¹ Crie tabelas de parÃ¢metros  
Fazer uma tabela de parÃ¢metro, criar uma variaÃ§Ã£o de custo e descobrir seu lucro a partir da variaÃ§Ã£o inserida no parÃ¢metro. 
FunÃ§Ãµes DAX em uso:
Cria-se um contexto de filtro, observando cada linha da tabela Pedidos Detalhes e cada quantidade Ã© multiplicada pelos custos relacionados na tabela Produtos, na coluna Custo PadrÃ£o, obtÃ©m-se Soma Custo com SUMX e RELATED
```
Soma Custo = SUMX('Pedidos Detalhes', 'Pedidos Detalhes'[Quantidade]*RELATED(Produtos[Custo PadrÃ£o]))  
```  
CÃ¡lculo do lucro  
``` 
Lucro = [Soma Vendas]-[Soma Custo]  
```  
Tabela de parÃ¢metro para criar a variaÃ§Ã£o que Ã© aplicada em Soma Custo para calcular o Lucro de acordo com o cenÃ¡rio escolhido pelos usuÃ¡rios do relatÃ³rio  
```
ParÃ¢metro = GENERATESERIES(0.01, 0.09, 0.001)  
```  
Medida Parametro Valor criada automaticamente junto com ParÃ¢metro  
```
ParÃ¢metro Valor = SELECTEDVALUE('ParÃ¢metro'[ParÃ¢metro], 0)  
```  
ğŸ”¹ Como criar medidas dinÃ¢micas  
FuncÃµes DAX em uso:
CÃ¡lculo do custo de variaÃ§Ã£o, somando Soma Custo com multiplicaÃ§Ã£o entre Soma Custo e ParÃ¢metro Valor
```
Soma Custo VariaÃ§Ã£o = Produtos[Soma Custo] + Produtos[Soma Custo]*'ParÃ¢metro'[ParÃ¢metro Valor]  
```  
AplicÃ¡vel em simulaÃ§Ãµes de novos investimentos com aumento do custo em 5,80%, em que Ã© avalido o cenÃ¡rio daqui, se compensa ou nÃ£o aumentar o custo em 5,80% para ter o lucro calculado na tabela que aponta para a soma de custos.  
CÃ¡lculo de Lucro VariaÃ§Ã£o  
```
Lucro VariaÃ§Ã£o = [Soma Vendas]-Produtos[Soma Custo VariaÃ§Ã£o]  
```  
Para as categorias que apresentam valores negativos Ã© recomendado ajuste do investimento para que todas gerem lucro.  
ğŸ”¹ Calcule o ano anterior com a SAMEPERIODLASTYEAR  
FunÃ§Ã£o DAX em uso:  
Exibe vendas do ano anterior ao lado da coluna dos meses do ano atual com CALCULATE que muda o contexto de filtro e SAMEPERIODLASYEAR que filtra os dados. 
```
Vendas Ano Anterior = CALCULATE([Soma Vendas],SAMEPERIODLASTYEAR('CalendÃ¡rio'[Data]))  
```  
ğŸ”¹ Calcule o mÃªs anterior com DATEADD  
DATEADD desloca um perÃ­odo conforme os argumentos inseridos nessa funÃ§Ã£o, com CALCULATE o contexto de filtro Ã© mudado e o mÃªs anterior Ã© trazido para outra coluna da tabela. No exemplo comparam-se as performances de vendas de mÃªs atual e mÃªs anterior, por isso Ã© acrescentado -1 como argumento do intervalo filtrado.  
```  
Vendas Mes Passado = CALCULATE([Soma Vendas],DATEADD('CalendÃ¡rio'[Data],-1,MONTH))
```  
ğŸ”¹ Acumule valores com funÃ§Ãµes de TOTALYDT, QTD, e MTD  
TOTALYTD acumula valores conforme o contexto de filtro atual. Sigla YTD significa Year To Date.
FunÃ§Ãµes DAX em uso:
Mostra acumulado de valores atÃ© o final do ano com CALCULATE e TOTALYTD, que recomeÃ§a a contagem a cada mudanÃ§a de ano. 
```  
Acumulado Year To Date 2 = TOTALYTD([Soma Vendas],'CalendÃ¡rio'[Data])   
```  
Mostra acumulado de valores por trimestre do ano com CALCULATE e TOTALQTD, que recomeÃ§a a contagem ao mudar de ano.  
``` 
Acumulado Year To Date Quarter = TOTALQTD([Soma Vendas],'CalendÃ¡rio'[Data])   
```  

â˜‘ï¸ **8. Organizando os visuais e compartilhando o projeto**  
ğŸ”¹ OrganizaÃ§Ã£o e publicaÃ§Ã£o do relatÃ³rio  
VisualizaÃ§Ã£o do relatÃ³rio Adventure_Report na [web](https://app.powerbi.com/reportEmbed?reportId=6fcd1e60-7567-480d-be1d-fac0cd7e1157&autoAuth=true&ctid=8a1ef6c3-8324-4103-bf4a-1328c5dc3653&config=eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly93YWJpLXNvdXRoLWNlbnRyYWwtdXMtcmVkaXJlY3QuYW5hbHlzaXMud2luZG93cy5uZXQvIn0%3D). 

ğŸ”¹ Formas de consumo de dados no Power BI  
 VersÃ£o do relatÃ³rio Adventure_Report em Dashboard  
   
<p align="center">
	<img src="" width="750">
</p>  


â˜‘ï¸ **ConclusÃ£o**  
ğŸ”¹ PrÃ³ximos passos para explorar seus conhecimentos e continuar aprendendo
Leitura sobre atualizaÃ§Ãµes mensais do Power BI no site oficial, sobretudo na seÃ§Ã£o do blog: https://powerbi.microsoft.com/pt-br/blog/.  

---

#### âœï¸ AUTORA  
Carla Edila Silveira  
Contato: rosa.carla@pucpr.edu.br  

---

#### Â©ï¸ LICENÃ‡A

[MIT](https://choosealicense.com/licenses/mit/)  

---  

#### ğŸ”— LINKS ÃšTEIS  

[[DATAB Live] Linguagem M - AvanÃ§ado de Verdade](https://www.youtube.com/watch?v=vYb-89PZf7U)  
[LINGUAGEM DAX: TUDO PARA COMEÃ‡AR A USAR DO JEITO CERTO](https://educaenter.com/aprenda-usar-a-linguagem-dax/)  
[Linguagem de fÃ³rmula Power Query M](https://docs.microsoft.com/pt-br/powerquery-m/)
[Power BI: Linguagens M e DAX](https://www.eng.com.br/artigo.cfm?id=7506&post=power-bi-linguagens-m-e-dax)  
[ReferÃªncia de DAX (Data Analysis Expressions)](https://docs.microsoft.com/pt-br/dax/)  
[RLS (seguranÃ§a em nÃ­vel de linha) com o Power BI](https://docs.microsoft.com/pt-br/power-bi/enterprise/service-admin-rls)  


---
